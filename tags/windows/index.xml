<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Windows on Ben Doyle blog</title><link>https://ben-doyle44.github.io/tags/windows/</link><description>Recent content in Windows on Ben Doyle blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 10 Oct 2022 05:48:00 -0400</lastBuildDate><atom:link href="https://ben-doyle44.github.io/tags/windows/index.xml" rel="self" type="application/rss+xml"/><item><title>Anthem</title><link>https://ben-doyle44.github.io/p/anthem/</link><pubDate>Mon, 10 Oct 2022 05:48:00 -0400</pubDate><guid>https://ben-doyle44.github.io/p/anthem/</guid><description>&lt;p>As with every box I started with an nmap scan.&lt;/p>
&lt;p>It shows 2 ports open, 80(http) and 3389(rdp)&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/nmapscan.png"
loading="lazy"
alt="nmap output"
>&lt;/p>
&lt;p>Question: What port is for the web server? Answer: 80&lt;/p>
&lt;p>Question: What port is for remote desktop service? Answer: 3389&lt;/p>
&lt;p>I first went to the website as I didn&amp;rsquo;t have credentials for rdp.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/anthemhomepage.png"
loading="lazy"
alt="anthem home page"
>&lt;/p>
&lt;p>I started with manual enumeration by going to /robots.txt which provided a possible password and 4 urls.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/robots.png"
loading="lazy"
alt="robots.txt"
>&lt;/p>
&lt;p>Question: What is a possible password in one of the pages web crawlers check for? Answer: UmbracoIsTheBest!&lt;/p>
&lt;p>Question: What CMS is the website using? Answer: Umbraco&lt;/p>
&lt;p>Question: What is the domain of the website? Answer: anthem.com&lt;/p>
&lt;p>I went back to the home page to see what other information I could gather. On the post &amp;ldquo;we are hiring&amp;rdquo; I found a potential email.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/wearehiring.png"
loading="lazy"
alt="we are hiring post"
>&lt;/p>
&lt;p>I moved onto the second post &amp;ldquo;a cheers to our it department&amp;rdquo;. It alludes to an admin but doesn&amp;rsquo;t directly name them.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/acheerstoit.png"
loading="lazy"
alt="a cheers to it department"
>&lt;/p>
&lt;p>I searched the poem up and got the name &amp;ldquo;Solomon Grundy&amp;rdquo;.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/poem.png"
loading="lazy"
alt="poem search"
>&lt;/p>
&lt;p>Question: What&amp;rsquo;s the name of the Administrator? Answer: Solomon Grundy&lt;/p>
&lt;p>With this name we can assume his email address has the same format as the other one, the first letter of their first and last name followed by @anthem.com.&lt;/p>
&lt;p>Question: Can we find find the email address of the administrator? Answer: &lt;a class="link" href="mailto:SG@anthem.com" >SG@anthem.com&lt;/a>&lt;/p>
&lt;p>I checked the source code of the site for the first 4 flags using curl to send and recieve data and grep to find the flag within it.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/flag1&amp;#43;2.png"
loading="lazy"
alt="flag1 and flag2"
>&lt;/p>
&lt;p>Question: What is flag 1? Answer: THM{L0L_WH0_US3S_M3T4}&lt;/p>
&lt;p>Question: What is flag 2? Answer: THM{G!T_G00D}&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/flag3.png"
loading="lazy"
alt="flag3"
>&lt;/p>
&lt;p>Question: What is flag 3? Answer: THM{L0L_WH0_D15}&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/flag4.png"
loading="lazy"
alt="flag4"
>&lt;/p>
&lt;p>Question: What is flag 3? Answer: THM{AN0TH3R_M3TA}&lt;/p>
&lt;p>With that finished, I moved onto logging into umbraco using the &amp;ldquo;&lt;a class="link" href="mailto:sg@anthem.com" >sg@anthem.com&lt;/a>&amp;rdquo; and &amp;ldquo;UmbracoIsTheBest!&amp;rdquo;.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/umbracohomepage.png"
loading="lazy"
alt="umbraco home page"
>&lt;/p>
&lt;p>I didnt find anything of use so I went onto trying to log in via rdp. I used &lt;a class="link" href="https://remmina.org/" target="_blank" rel="noopener"
>remmina&lt;/a> for this&lt;/p>
&lt;p>I logged in using the username &amp;ldquo;sg&amp;rdquo; and the password &amp;ldquo;UmbracoIsTheBest!&amp;rdquo;&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/desktop.png"
loading="lazy"
alt="desktop"
>&lt;/p>
&lt;p>I then opened the user.txt file giving me the user flag.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/userflag.png"
loading="lazy"
alt="user flag"
>&lt;/p>
&lt;p>Question: Gain initial access to the machine, what is the contents of user.txt? Answer: THM{N00T_NO0T}&lt;/p>
&lt;p>I looked around for any interesting files and came accross the directory backup.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/files.png"
loading="lazy"
alt="files"
>&lt;/p>
&lt;p>Inside backup was a text file called &amp;ldquo;restore&amp;rdquo; but I didn&amp;rsquo;t have permission to open it.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/restoreperm.png"
loading="lazy"
alt="restore permissions"
>&lt;/p>
&lt;p>I did however, have permission to change the permissions on it.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/properties.png"
loading="lazy"
alt="restore properties"
>&lt;/p>
&lt;p>I clicked on the edit button, then add and then add sg in the &amp;ldquo;enter the object name to select&amp;rdquo; area.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/user-group.png"
loading="lazy"
alt="user-group"
>&lt;/p>
&lt;p>Then clicked allow full control over the restore file to the user SG.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/addingperms.png"
loading="lazy"
alt="adding perms"
>&lt;/p>
&lt;p>Opening it gives us &amp;ldquo;ChangeMeBaby1MoreTime&amp;rdquo;.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/rootpass.png"
loading="lazy"
alt="root password"
>&lt;/p>
&lt;p>Question: Can we spot the admin password? Answer: ChangeMeBaby1MoreTime&lt;/p>
&lt;p>I then looked for the administrator&amp;rsquo;s files to get the root flag&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/adminarea.png"
loading="lazy"
alt="admin area"
>&lt;/p>
&lt;p>I found the root file on the admin&amp;rsquo;s dekstop.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/admindekstop.png"
loading="lazy"
alt="admin dekstop"
>&lt;/p>
&lt;p>Opening that file gives us the final flag.&lt;/p>
&lt;p>&lt;img src="https://ben-doyle44.github.io/img/anthem/rootflag.png"
loading="lazy"
alt="root flag"
>&lt;/p>
&lt;p>Question: Escalate your privileges to root, what is the contents of root.txt? Answer: THM{Y0U_4R3_1337}&lt;/p></description></item></channel></rss>